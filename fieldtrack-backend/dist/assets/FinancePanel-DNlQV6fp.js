import{_ as w,C as k,p as A,i as E,j as S,A as j,r as c,k as D,o as P,c as n,a as r,b as e,d as x,t as o,l as R,f as C,P as F,F as I,g as $,h as p}from"./index-BQ6H7z-i.js";const B={class:"p-6 space-y-6 bg-gray-100 min-h-screen"},N={class:"flex justify-between items-center mb-4"},z={key:0,class:"text-sm text-gray-500"},V={key:0,class:"text-center text-lg text-gray-600"},L={key:1,class:"text-center text-red-500 text-lg"},O={key:2,class:"space-y-8"},T={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},K={class:"bg-blue-50 p-4 rounded shadow text-center"},M={class:"text-2xl font-bold text-blue-600"},U={class:"bg-yellow-50 p-4 rounded shadow text-center"},W={class:"text-2xl font-bold text-yellow-600"},q={class:"bg-green-50 p-4 rounded shadow text-center"},G={class:"text-2xl font-bold text-green-600"},H={class:"bg-red-50 p-4 rounded shadow text-center"},J={class:"text-2xl font-bold text-red-600"},Q={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},X={class:"bg-white p-6 rounded shadow"},Y={class:"bg-white p-6 rounded shadow"},Z={class:"overflow-x-auto"},ee={class:"w-full text-sm text-left text-gray-700"},te={class:"p-2"},se={class:"p-2"},ae={class:"p-2"},oe={class:"p-2"},le={class:"p-2"},ne=["href"],re={key:1,class:"text-gray-400"},ce={class:"p-2"},de={class:"p-2 flex space-x-2"},ie=["onClick"],pe=["onClick"],ue={key:0,class:"mt-4 text-gray-500 text-center"},ge={__name:"FinancePanel",setup(he){k.register(A,E,S,j);const d=c(null),u=c([]),l=c({totalExpenses:0,pending:0,approved:0,rejected:0}),g=c(!0),i=c(null),v=D(()=>({labels:["Pending","Approved","Rejected"],datasets:[{backgroundColor:["#facc15","#4ade80","#f87171"],data:[l.value.pending,l.value.approved,l.value.rejected]}]})),_={responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Expense Status Overview"}}},y=async()=>{try{const a=localStorage.getItem("token"),t=await p.get("http://localhost:5000/api/profile/me",{headers:{Authorization:`Bearer ${a}`}});d.value=t.data}catch(a){console.error("Error fetching profile:",a)}},h=async()=>{g.value=!0,i.value=null;try{const a=localStorage.getItem("token"),{data:t}=await p.get("http://localhost:5000/api/expenses",{headers:{Authorization:`Bearer ${a}`}});l.value.totalExpenses=t.length,l.value.pending=t.filter(s=>s.Approval_Status==="Pending").length,l.value.approved=t.filter(s=>s.Approval_Status==="Approved").length,l.value.rejected=t.filter(s=>s.Approval_Status==="Rejected").length,u.value=t.filter(s=>s.Approval_Status==="Pending")}catch(a){i.value="Failed to load finance data.",console.error("Finance fetch error:",a)}finally{g.value=!1}};P(()=>{h(),y()});const f=async a=>{try{await p.put(`http://localhost:5000/api/expenses/approve/${a}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),h()}catch(t){console.error("Approve error:",t)}},m=async a=>{try{await p.put(`http://localhost:5000/api/expenses/reject/${a}`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),h()}catch(t){console.error(" Reject error:",t)}};return(a,t)=>(r(),n("div",B,[e("div",N,[e("div",null,[t[0]||(t[0]=e("h1",{class:"text-3xl font-bold text-gray-800"},"Finance Dashboard",-1)),d.value?(r(),n("p",z,"Welcome, "+o(d.value.Name)+" ("+o(d.value.Department)+")",1)):x("",!0)]),t[1]||(t[1]=e("div",{class:"flex items-center space-x-4"},null,-1))]),g.value?(r(),n("div",V,"‚è≥ Loading finance data...")):i.value?(r(),n("div",L,o(i.value),1)):(r(),n("div",O,[e("div",T,[e("div",K,[t[2]||(t[2]=e("h3",{class:"text-sm text-gray-500"},"Total Expenses",-1)),e("p",M,o(l.value.totalExpenses),1)]),e("div",U,[t[3]||(t[3]=e("h3",{class:"text-sm text-gray-500"},"Pending Approvals",-1)),e("p",W,o(l.value.pending),1)]),e("div",q,[t[4]||(t[4]=e("h3",{class:"text-sm text-gray-500"},"Approved",-1)),e("p",G,o(l.value.approved),1)]),e("div",H,[t[5]||(t[5]=e("h3",{class:"text-sm text-gray-500"},"Rejected",-1)),e("p",J,o(l.value.rejected),1)])]),e("div",Q,[e("div",X,[t[6]||(t[6]=e("h2",{class:"text-xl font-semibold mb-4"},"üìä Expense Status Overview",-1)),R(C(F),{data:v.value,options:_},null,8,["data"])]),e("div",Y,[t[8]||(t[8]=e("h2",{class:"text-xl font-semibold mb-4"},"üìã Pending Expenses",-1)),e("div",Z,[e("table",ee,[t[7]||(t[7]=e("thead",{class:"bg-gray-100 text-xs uppercase"},[e("tr",null,[e("th",{class:"p-2"},"Employee"),e("th",{class:"p-2"},"Type"),e("th",{class:"p-2"},"Amount"),e("th",{class:"p-2"},"Date"),e("th",{class:"p-2"},"Receipt"),e("th",{class:"p-2"},"Status"),e("th",{class:"p-2"},"Actions")])],-1)),e("tbody",null,[(r(!0),n(I,null,$(u.value,s=>(r(),n("tr",{key:s.Expense_ID,class:"border-t hover:bg-gray-50"},[e("td",te,o(s.Employee_Name),1),e("td",se,o(s.Expense_Type),1),e("td",ae,"KSh "+o(s.Amount),1),e("td",oe,o(new Date(s.Date_Submitted).toLocaleDateString()),1),e("td",le,[s.Receipt?(r(),n("a",{key:0,href:s.Receipt,target:"_blank",class:"text-blue-600 underline"},"View",8,ne)):(r(),n("span",re,"No Receipt"))]),e("td",ce,o(s.Approval_Status),1),e("td",de,[e("button",{onClick:b=>f(s.Expense_ID),class:"bg-green-500 hover:bg-green-600 text-white text-xs px-3 py-1 rounded"}," ‚úÖ Approve ",8,ie),e("button",{onClick:b=>m(s.Expense_ID),class:"bg-red-500 hover:bg-red-600 text-white text-xs px-3 py-1 rounded"}," ‚ùå Reject ",8,pe)])]))),128))])]),u.value.length===0?(r(),n("p",ue," All expenses are reviewed! ")):x("",!0)])])])]))]))}},ve=w(ge,[["__scopeId","data-v-c5b0f2e0"]]);export{ve as default};
